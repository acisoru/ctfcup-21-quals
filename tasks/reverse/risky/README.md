# Reverse | medium | Risky Business

## Информация

> Поговаривают, что заниматься анализом таким приложений опасно для жизни.
>
> Наш агент тоже боится подходить к изучение этого файла.
>
> Может у вас что выйдет?
> 

## Деплой

Не требуется

## Выдать участинкам

Архив из директории [public/](public/)

## Описание

ELF 64bit, C, RISC-V 64


## Решение

1. Загружаем файл в Ghidra 
2. Можно сразу обратить внимание на большие функции инициализации в .init_array (функции `FUN_000105e4` и `FUN_0001115e`)
3. Первая функция похожа на инициализацию некоторых массивов разной длины (всего 27 штук), а вторая на инициализацию какой-то сложной структуры
4. Немного изучив код, можно понять, что перед нами двоичное дерево поиска, которое инициализируется на этапе запуска приложения
5. Массив констант является путями в дереве по которым находятся символы флага
6. Логика работы бинаря довольно простая, на каждый введённый символ ищется путь в дереве и сравнивается с заложенным в бинарнике
7. Необходимо сгенерировать аналогичное дерево (или сдампить его из памяти) и пройти пути заложенные в бинаре
8. Так-как существует некоторая неодназначность в поиске в бинаре есть хэш оригинального флага

[Пример построения дерева и получения всех возможных символов для определённых путей](solution/main.c)
[Пример поиска флага через имеющийся MD5-хэш от флага](solution/helper.py)


## Флаг

`CUP{1nCRed1ble+Rever5+T45k}`