# Reverse | easy | Ultimate Password Protector

## Информация

> Проводя разведывательную работу наш агент наткнулся на старый терминал защищающий одноразовые пароли клиентов.
> 
> Затаившись в кустах и дождавшись пока от терминала отойдёт очередной клиент, агент подбежал к терминалу и снял дамп памяти.
>
> В дампе остался пароль прошлого клиента, но он зашифрован.
>
> Агент прислал нам файл и ждёт от вас помощи в расшифровке.
> 


## Деплой

Не требуется

## Выдать участинкам

Архив из директории [public/](public/)

## Описание

Windows Crash Dump 64bit

Смысл таска заключается в восстановлении закодированного пароля из дампа процесса.

## Решение

1. Открываем дам в IDA PRO и по call-stack находим основную функцию программы (`sub_7FF7CBD61370`)
2. Анализируя функцию можно обнаружить, что программа поддерживает всего две опции: зашифровать и расшифровать пароль
3. Для начала нам надо понять куда сохраняется зашифрованный пароль, поэтому смотрим функцию `sub_7FF7CBD61710`
4. Анализируя функцию шифрования пароля можно обнаружить, что указатель на зашифрованный пароль хранится где-то в сегменте глобальных данных, а пароль на куче, при этом шифрование на самом деле является двух-байтовой заменой каждого символа по простой формуле.
5. Каждое значение символа пароля разбивается на два числа путём целочисленного деления на 16 и взятия модуля по базе 16.
6. Находим указатель на преобразованный пароль (указатель находится по адресу `off_7FF7CBD666F8`, а сами данные пароля по `0x1590A6F49A0`)
7. Далее надо найти массивы по которым производится замена, они находятся по адресам `0x7FF7CBD64530` и `0x7FF7CBD64540`
8. Реализуем простой скрипт обратного преобразования.

[Пример обратного преобразования пароля](solution/solve.py)

## Флаг

`CUP{8ee5dfeea690b580f46239c4496873c8}`
