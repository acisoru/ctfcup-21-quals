# Forensics | hard | Simple Secure File System

## Информация

> Мы получили образ одной ФС, но оказалось, что она проприетарная.
> 
> Кто-то придумал странный формат хранения своих файлов, кажется, что часть из них зашифрована
>
> Попробуйте разобраться как достать файлы.
> 
> Нам удалось понять лишь то, что могут использоваться разные алгоритмы шифрования файлов.
> 

## Деплой

Не требуется

## Выдать участинкам

Архив из директории [public/](public/)

## Описание

Небольшая кастомная файловая система с шифрованием файлов различными алгоритмами

## Решение

1. Анализируем формат файла и приходим к выводу, что у нас есть таблица описывающая файлы
2. Каждый файл описывается 56-байтам в которых содержится смещение, размер, контрольная сумма и имя файла
3. По смещению находится простой заголовок в котором указывается 1 байтом алгоритм шифрования, далее размер и ключ (всегда 16 байт, но для DES 8 байт)
4. Парсим все данные с помощью скрипта и распаковываем файлы. Можно распаковать только 4 разных части флага

[скрипт распаковки всех файлов](solution/unpacker.py)

## Флаг

`CUP{db07a14ca32aad07d28d2576b3123230}`